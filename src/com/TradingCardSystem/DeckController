package com.TradingCardSystem;

import java.util.Scanner;

public class DeckController {
    private Collector collector;
    private DeckView deckView;

    public DeckController(Collector collector, DeckView deckView) {
        this.collector = collector;
        this.deckView = deckView;
    }

    public DeckController() {
        this.collector = new Collector();
        this.deckView = new DeckView();
    }

    public boolean addCardToDeck(Deck deck){
        collector.displayCards();

        String cardName = deckView.promptAddCardToDeck();

        Card card = collector.getCardWithName(cardName);
        if (card == null){
            deckView.displayCardNotFound();
            return false;
        }
        if (deck.getCardCount() >= 10) {
            deckView.displayMaxCardCountReached();
            return false;
        }
        if (deck.getCards().contains(card)) {
            deckView.displayCardExists();
            return false;
        }
        if (!collector.getCards().contains(card)) {
            deckView.displayCardNotFound();
            return false;
        }

        deck.addCard(card);
        collector.removeCardObject(cardName);
        System.out.println("Card added successfully");
        return true;
    }

    public boolean removeCardFromDeck(Deck deck){
        displayCardsInDeck(deck);

        String cardName = deckView.promptRemoveCardFromDeck();

        Card card = null;
        for(Card c : deck.getCards()){
            if(c.getName().equalsIgnoreCase(cardName)){
                card = c;
            }
        }
        if(card == null){
            System.out.println("Invalid card name");
            return false;
        }
        
        deck.removeCard(card);
        collector.addCard(card);
        System.out.println("Card removed successfully!");
        return true;
    }

    public void displayCardsInDeck(Deck deck){
        System.out.println("Here are the available cards in the deck:");
        int i = 0;
        for(Card card : deck.getCards()){
            System.out.printf("Card %d\nCard Name: %s\nRarity: %s\nVariant: %s\nValue: %.2f\n",
                    i+1,
                    card.getName(),
                    card.getRarity(),
                    card.getVariant(),
                    card.getValue());
            i++;
        }
    }
}
